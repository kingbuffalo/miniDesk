# MiniQDesktop

本项目是因为腾讯的产品 小Q书桌 下架了。
自己使用 deepseek 生成大部分的代码，我自己只是解决一下运行时报错，和一些使用上的习惯而已。

MiniQDesktop 是一个基于 Python 和 Tkinter 的桌面快捷方式管理工具，支持文件和文件夹的快捷方式分组管理，提供系统托盘图标、全局快捷键等功能。

## 功能特性

- **快捷方式管理**：支持添加文件和文件夹快捷方式，并按分组管理
- **分组功能**：可以创建、删除分组，并将快捷方式添加到指定分组
- **系统托盘图标**：支持最小化到系统托盘，并通过托盘菜单显示或退出程序
- **全局快捷键**：通过 `Alt+Z` 快捷键快速唤起主窗口
- **窗口拖动**：支持通过鼠标拖动窗口
- **自定义窗口位置**：默认显示在屏幕左下角，宽度为 1000 像素
- **单实例运行**：防止重复启动，确保同时只有一个程序实例运行
- **使用说明**：`+` 代表文件快捷方式，`++` 代表文件夹快捷方式

## 安装

1. 克隆项目到本地：
   ```bash
   git clone https://github.com/kingbuffalo/miniDesk.git
   cd miniDesk
   ```

2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

3. 运行程序：
   ```bash
   python main.py
   ```
   
   或者直接运行：
   ```bash
   run.bat
   ```

## 使用说明

1. **添加快捷方式**：
   - 点击 `+` 按钮选择文件快捷方式
   - 点击 `++` 按钮选择文件夹快捷方式
   - 选择分组或创建新分组后，快捷方式将被添加到指定分组

2. **管理分组**：
   - 点击 `new group` 按钮创建新分组
   - 点击分组右侧的 `X` 按钮删除分组

3. **系统托盘**：
   - 程序最小化后会显示在系统托盘
   - 右键托盘图标可以选择显示主窗口或退出程序

4. **全局快捷键**：
   - 按下 `Alt+Z` 快捷键可以快速唤起主窗口

5. **单实例运行**：
   - 程序启动时会检查是否已有实例运行，防止重复启动

## 文件结构

```
miniDesk/
├── main.py              # 主程序入口文件
├── MiniQDesktop.py      # 核心功能模块
├── shortcuts.json       # 快捷方式数据文件（运行后生成）
├── requirements.txt     # 依赖库列表
├── run.bat              # Windows 运行批处理文件
├── app.lock             # 单实例锁文件（运行时生成）
├── readme.md            # 项目说明文件
└── icons/               # 图标文件夹
    ├── default_folder_icon.png
    ├── exe_icon.png
    └── icon.png
```

## 依赖

以下是项目所需的主要依赖库：

- `tkinter`：用于创建图形用户界面（Python 内置库）
- `Pillow==9.3.0`：用于图像处理和系统托盘图标
- `pystray==0.19.4`：用于系统托盘功能
- `keyboard==0.13.5`：用于全局快捷键支持
- `psutil`：用于进程管理和单实例检查

安装依赖：
```bash
pip install -r requirements.txt
pip install psutil  # 单独安装 psutil
```

## 注意事项

- **管理员权限**：由于 `keyboard` 模块需要全局监听键盘事件，运行程序时可能需要管理员权限
- **快捷方式数据**：快捷方式数据保存在 `shortcuts.json` 文件中，删除该文件会清空所有分组和快捷方式
- **单实例运行**：程序使用 `app.lock` 文件确保同时只运行一个实例
- **系统兼容性**：主要适用于 Windows 系统

## 开发背景

本项目的开发缘起于腾讯"小Q书桌"产品的下架。作为该产品的用户，为了延续类似的使用体验，使用 DeepSeek AI 辅助生成了大部分代码，并手动解决了运行时错误和使用习惯优化。

## 贡献

欢迎提交 Issue 或 Pull Request 来改进此项目。

## 许可证

本项目采用 [MIT License](LICENSE) 进行许可。
```